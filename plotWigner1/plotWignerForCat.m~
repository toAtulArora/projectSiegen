max=100
half=max/2
par=2.0
alpha=par+par*1i;
beta=-par-par*1i;
r_d=linspace(-4*pi,4*pi,max);
x=repmat(r_d,max);
x=repmat(r_d,max,1);
y=repmat(r_d',1,max);
lambda=x+1i*y;
% f=exp(-0.5*( lambda.*conj(lambda) + conj(lambda).*alpha - conj(alpha).*lambda));
% f=exp(-abs(lambda - alpha).^2);

f1=exp(-0.5*(abs(alpha).^2) -0.5*(abs(alpha + lambda).^2) - conj(alpha).*(lambda+alpha));
f2=exp(-0.5*(abs(beta).^2) -0.5*(abs(alpha + lambda).^2) - conj(beta).*(lambda+alpha));
f3=exp(-0.5*(abs(alpha).^2) -0.5*(abs(beta + lambda).^2) - conj(alpha).*(lambda+beta));
f4=exp(-0.5*(abs(beta).^2) -0.5*(abs(beta + lambda).^2) - conj(beta).*(lambda+beta));

% 
 f=f1+f2+f3+f4;
% f=f1+f2+f3+f4;


% f=exp(-0.5*(abs(alpha).^2) -0.5*(abs(alpha + lambda).^2) - conj(alpha).*(lambda+alpha));
subplot(2,2,1);
contourf(abs(f),10);
title('abs(tr($\rho D(\lambda )$))','interpreter','latex')
subplot(2,2,2);
contourf(angle(f),10);

w=fft2(f);
subplot(2,2,3);
contourf(abs(w([half:max 1:half],[half:max 1:half])),10)
subplot(2,2,4);
contourf(angle(w([half:max 1:half],[half:max 1:half])),10)
% contourf(angle(w(1:100,1:100)),10)

% subplot(2,2,3);
% contourf(abs(w(1:100,1:100)),10)
% subplot(2,2,4);
% contourf(angle(w(1:100,1:100)),10)

% plot3(w)



% lambdaMat=x+i*y;
% lambda=reshape(lambdaMat,1,1000000)
% lambda=reshape(lambdaMat,1,1000000);
% f=exp(-0.5*( lambda.*conj(lambda) + conj(lambda).*alpha - conj(alpha).*lambda))
% f=exp(-0.5*( lambda.*conj(lambda) + conj(lambda).*alpha - conj(alpha).*lambda));
% w=fft(f)